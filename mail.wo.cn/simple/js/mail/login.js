$(function(){$("#Cname_content").keyup(function(){textChanges(this);});$("#Cpwd_pwd").keyup(function(){textChanges(this);});$("#Cverify_content").keyup(function(){textChanges(this);});});function checkInputData(){var user=document.getElementById("Cname_content");var cookieEnabled=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled=(document.cookie=="testcookie")?true:false;document.cookie="";}if(!cookieEnabled){setErrorMsg("loginErrorMsg","浏览器未启用cookie");user.focus();return false;}var passwordInput=document.getElementById("Cpwd_pwd");var verifyCodeInput=document.getElementById("Cverify_content");var userName=user.value.trim();if(userName.length==0){setErrorMsg("loginErrorMsg","用户名不能为空");user.focus();return false;}user.value=userName;if(passwordInput.value.trim().length==0){setErrorMsg("loginErrorMsg","密码不能为空");passwordInput.focus();return false;}if(verifyCodeInput!=null&&verifyCodeInput.value.trim().length==0){if($("#verifycodeDiv").css("display")!="none"){setErrorMsg("loginErrorMsg","验证码不能为空");verifyCodeInput.focus();return false;}}var l=userName.replace(/[^\x00-\xFF]/g,"**").length;var userValue=userName;if(l!=11||userValue.substring(0,1)!="1"){if((l<1)){setErrorMsg("loginErrorMsg","用户名长度为1～20个字符");return false;}var reg=/^[a-zA-Z0-9.\-_]+$/;flag=reg.test(userName);if(!flag){setErrorMsg("loginErrorMsg","用户名只能由小写英文字母(a-z)，数字(0-9)，下划线(_)，减号(-)和点(.)组成");return false;}}l=passwordInput.value.replace(/[^\x00-\xFF]/g,"**").length;if((l<1)||(l>32)){setErrorMsg("loginErrorMsg","密码长度为1～32个字符");return false;}var passwordInputHid=document.getElementById("password1");passwordInputHid.value=passwordInput.value.trim();return true;}function setErrorMsg(msgId,msgContent){var objMsg=document.getElementById(msgId);var objError=document.getElementById("loginError");if(objMsg!=null){objMsg.innerHTML=msgContent;}if(objError!=null){objError.style.display="";}}function toRegisterPage(){var obj=document.getElementById("registNow");if(obj!=null){obj.onclick=function(){var form=document.getElementById("regist");form.submit();};}}function toResetPasswordPage(){var obj=document.getElementById("toResetPasswordPage");if(obj!=null){obj.onclick=function(){var form=document.getElementById("resetPw");form.submit();};}}function toWoInterconnectionLogin(){$("#woInterconnectionLoginBtn").click(function(){$("#woInterconnectionLogin").show();$("#Cname_content1").focus();var tip1=document.getElementById("Cname_content1_tip1");var ctext=document.getElementById("Cname_content1");if(tip1!=null&&ctext!=null){if(ctext.value.trim().length>=1){tip1.style.display="none";}else{tip1.style.display="block";}}else{tip1.style.display="block";}$("#normalLogin").hide();});}function toNormalLogin(){$("#normalLoginBtn").click(function(){$("#Cname_content").focus();$("#woInterconnectionLogin").hide();$("#normalLogin").show();});}function whlPopClose(){$("#whlPopBtn").click(function(){$(".whlpop").hide();});}function refreshVerifyCode(){var obj=document.getElementById("loginVerifyCodeImg");var ran=tool.randomUUID();obj.removeAttribute("src");obj.setAttribute("src","verifyCode?ran="+ran);var ranNum=document.getElementById("ran");ranNum.setAttribute("value",ran);_hmt.push(["_trackEvent","login","login_verifycoderefresh"]);}function refreshVerifyCode1(){var obj=document.getElementById("loginVerifyCodeImg1");var ran=tool.randomUUID();obj.removeAttribute("src");obj.setAttribute("src","verifyCode?ran="+ran);var ranNum=document.getElementById("ran1");ranNum.setAttribute("value",ran);}function cls(ele){var tip=document.getElementById(ele.id+"_tip");document.getElementById(ele.id+"_div").style.borderBottomColor="#59B5FC";}function cls1(ele){var tip=document.getElementById(ele.id+"_tip1");document.getElementById(ele.id+"_div1").style.borderBottomColor="#59B5FC";}function res(ele1){var tip1=document.getElementById(ele1.id+"_tip");var div=document.getElementById(ele1.id+"_div").style.borderBottomColor="#E5E5E5";var ctext=document.getElementById(ele1.id);if(tip1!=null&&ctext!=null){if(ctext.value.trim().length!=0){tip1.style.display="none";}else{tip1.style.display="block";}}}function res1(ele1){var tip1=document.getElementById(ele1.id+"_tip1");var div=document.getElementById(ele1.id+"_div1").style.borderBottomColor="#E5E5E5";var ctext=document.getElementById(ele1.id);if(tip1!=null&&ctext!=null){if(ctext.value.trim().length!=0){tip1.style.display="none";}else{tip1.style.display="block";}}}function textChanges(ele1){var tip1=document.getElementById(ele1.id+"_tip");var ctext=document.getElementById(ele1.id);if(tip1!=null&&ctext!=null){if(ctext.value.trim().length>=1){tip1.style.display="none";}else{tip1.style.display="block";}}else{tip1.style.display="block";}setErrorMsg("loginErrorMsg","");}function textChanges1(ele1){var tip1=document.getElementById(ele1.id+"_tip1");var ctext=document.getElementById(ele1.id);if(tip1!=null&&ctext!=null){if(ctext.value.trim().length>=1){tip1.style.display="none";}else{tip1.style.display="block";}}else{tip1.style.display="block";}setErrorMsg("loginErrorMsg1","");$("#loginSubmitBtn1").html($("#loginSubmitBtn1").html().replace("重新登录","登录"));}function init(realPassword){toResetPasswordPage();toRegisterPage();toWoInterconnectionLogin();toNormalLogin();whlPopClose();var obj=document.getElementById("loginVerifyCodeImg");if(obj!=null&&obj!=undefined){refreshVerifyCode();var obj=document.getElementById("refreshVerifyCode");obj.onclick=function(){refreshVerifyCode();};}var obj=document.getElementById("Cname_content");var obj1=document.getElementById("Cname_content_tip");if(obj.value.trim().length!=0){obj1.style.display="none";}obj.focus();var Cname_content=$("#Cname_content").val().trim();if(Cname_content!=null&&Cname_content!=""){document.getElementById("Cname_content_tip").innerHTML="";$.post("login.action",{actionType:"isShowVerifycode","loginReq.user":$("#Cname_content").val().trim()},function(data){if(data.isShowVerifycode==1){$("#verifycodeDiv").show();$(".registeredButton").hide();$("#registLink").show();$(".clientBox:first").css("width","241px").css("float","none");$("#woInterconnectionLoginDiv").hide();}else{$("#verifycodeDiv").hide();$(".registeredButton").show();$("#registLink").hide();$(".clientBox:first").css("width","150px").css("float","left");$("#woInterconnectionLoginDiv").show();}});}var obj=document.getElementById("isAutoLogin");obj.onclick=function(){var val=document.getElementById("isAutoLogin");if(val.checked){val.setAttribute("value",1);}else{val.setAttribute("value",0);}};var obj2=document.getElementById("isAutoLogin1");obj2.onclick=function(){var val=document.getElementById("isAutoLogin1");if(val.checked){val.setAttribute("value",1);}else{val.setAttribute("value",0);}};var submitBtn=document.getElementById("loginSubmitBtn");if(submitBtn!=null){submitBtn.onclick=function(){if(!checkInputData()){return false;}var form=document.getElementById("loginForm");document.getElementById("username1").value=document.getElementById("Cname_content").value.trim();document.getElementById("password1").value=document.getElementById("Cpwd_pwd").value.trim();document.getElementById("autoLogin").value=document.getElementById("isAutoLogin").value;var vcode1=document.getElementById("vCode1");if(vcode1!=null){vcode1.removeAttribute("name");var vcode=document.getElementById("Cverify_content");if(vcode){vcode1.setAttribute("name","verifyCode");vcode1.value=vcode.value.trim();}}if(realPassword!=""&&realPassword!=undefined){$("#password1").val(realPassword);form.submit();}else{var rsa=new RSAKey();rsa.setPublic("dd6be3d4de56287b8c3616b33bc1b7a5a2bb9148252140262420ee047f83b3165fb7674a759d60c24b71fd5437c7810f127f2c4370c2d4bdfcb55c08f1b3c715b7b2f57228e78e34039d2b967f54a58e345bc91e3dd54c7bea86d73c9e2de968736bf2b97f50bea891aa3519ae7238d76dff57cabba7cc0d370775657f3b5c83","10001");$("#password1").val(rsa.encrypt($("#password1").val()));form.submit();}};}document.onkeydown=function(event){e=event?event:(window.event?window.event:null);if(e.keyCode==13){submitBtn.click();}};$("#qrlogin").click(function(){var dis_=$("#qrdiv").css("display");if("none"==dis_){getLoginCode();$(".QRimg").css("display","block");}else{$(".QRimg").css("display","none");}});$("#Cname_content").blur(function(){if($("#Cname_content").val().trim()==""){$("#verifycodeDiv").hide();$(".registeredButton").show();$("#registLink").hide();$(".clientBox:first").css("width","150px").css("float","left");$("#woInterconnectionLoginDiv").show();return;}$.post("login.action",{actionType:"isShowVerifycode","loginReq.user":$("#Cname_content").val().trim()},function(data){if(data.isShowVerifycode==1){$("#verifycodeDiv").show();$(".registeredButton").hide();$("#registLink").show();$(".clientBox:first").css("width","241px").css("float","none");$("#woInterconnectionLoginDiv").hide();}else{$("#verifycodeDiv").hide();$(".registeredButton").show();$("#registLink").hide();$(".clientBox:first").css("width","150px").css("float","left");$("#woInterconnectionLoginDiv").show();}});});$("#Cname_content1").keyup(function(){var phone=$("#Cname_content1").val().trim();if(checkTelPhoneNumber(phone)){$.post("login.action",{actionType:"isShowVerifycode1","user":phone},function(data){$("#loginErrorMsg").html("");if(data.isShowVerifycode==1){refreshVerifyCode1();$("#verifycodeDiv1").show();$("#loginInputCheckbox").hide();}else{$("#verifycodeDiv1").hide();$("#loginInputCheckbox").show();}});}});$("#loginSubmitBtn1").click(loginSubmit);function loginSubmit(){var phone=$("#Cname_content1").val().trim();if(!checkTelPhoneNumber(phone)){setErrorMsg("loginErrorMsg1","请输入正确的联通手机号");return;}var param="";if($("#verifycodeDiv1").css("display")!="none"){var verifyCode=$("#Cverify_content1").val().trim();if(verifyCode==""){setErrorMsg("loginErrorMsg1","验证码不能为空");$("#Cverify_content1").focus();return false;}param={user:phone,actionType:"woInterconnectionLogin",isAutoLogin:$("#isAutoLogin1").val(),verifyCode:verifyCode,ran:$("#ran1").val().trim()};}else{param={user:phone,actionType:"woInterconnectionLogin",isAutoLogin:$("#isAutoLogin1").val()};}$("#loginSubmitBtn1").html('<img src="/simple/images/imageslogin/MC_icon_white.png" width="16" height="16" style="float:none; margin:-3px 5px 0 0;" align="absmiddle"/>登录');$("#loginSubmitBtn1").attr("style","background:#ccc; border:solid 1px #ccc;");$("#loginSubmitBtn1").unbind("click");var i=60;var clock=setInterval(function(){$("#Cname_content1_tip1").css("right","-150px").css("display","block");$("#Cname_content1_tip1").text(i+"s");i=i-1;if(i==-1){clearInterval(clock);$("#Cname_content1_tip1").text("");}},1000);$.post("login.action",param,function(data){if(data.result!="0000"){$("#loginSubmitBtn1").html('<img src="/simple/images/imageslogin/MC_icon_white.png" width="16" height="16" style="float:none; margin:-3px 5px 0 0;" align="absmiddle"/>重新登录');$("#loginSubmitBtn1").attr("style","");clearInterval(clock);refreshVerifyCode1();}$("#Cname_content1_tip1").text("");$("#loginSubmitBtn1").click(loginSubmit);setErrorMsg("loginErrorMsg1","");if(data.result=="0000"){window.location.href="welcome.action";}else{if(data.result=="1003"){setErrorMsg("loginErrorMsg1","登录失败，请重试");}else{if(data.result=="1002"){setErrorMsg("loginErrorMsg1","验证码错误");$("#Cverify_content1").val("");$("#verifycodeDiv1").show();$("#loginInputCheckbox").hide();}else{if(data.result=="1006"){setErrorMsg("loginErrorMsg1","注册失败，请稍后再试");}else{if(data.result=="1007"){setErrorMsg("loginErrorMsg1","注册成功，登录失败，请稍后再试");}else{if(data.result=="1000"){setErrorMsg("loginErrorMsg1","系统错误，请稍后再试");}else{if(data.result=="1001"){setErrorMsg("loginErrorMsg1","用户名不能为空");}else{if(data.result=="02"){setErrorMsg("loginErrorMsg1","密码错误");}else{if(data.result=="03"){setErrorMsg("loginErrorMsg1","登录超时，或者您的沃互联服务未开通");}else{if(data.result=="11"){setErrorMsg("loginErrorMsg1","登录取消");}else{setErrorMsg("loginErrorMsg1","登录失败，请重试");}}}}}}}}}}});}}function checkTelPhoneNumber(phone){if(phone==""||phone==undefined||phone==null){return false;}if(isNaN(phone)){return false;}if(phone.length!=11){return false;}var result=false;var param={actionType:"checkNumInfo",user:phone};$.ajax({type:"POST",data:param,url:"register.action",async:false,success:function(data){var resultCode=data.resultCode;if(resultCode==0){result=true;}}});if(!result){return false;}return true;}function checkInputDataForMailShare(){var user=document.getElementById("Cname_content");var cookieEnabled=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled=(document.cookie=="testcookie")?true:false;document.cookie="";}if(!cookieEnabled){$(".shareIndexPrompt").text("浏览器未启用cookie").next().css("margin-top",0);$(".shareIndexLeft").css("margin-top",0);user.focus();return false;}var passwordInput=document.getElementById("Cpwd_pwd");var verifyCodeInput=document.getElementById("Cverify_content");var userName=user.value.trim();if(userName.length==0){$(".shareIndexPrompt").text("用户名不能为空").next().css("margin-top",0);$(".shareIndexLeft").css("margin-top",0);user.focus();return false;}user.value=userName;if(passwordInput.value.trim().length==0){$(".shareIndexPrompt").text("密码不能为空").next().css("margin-top",0);$(".shareIndexLeft").css("margin-top",0);passwordInput.focus();return false;}var l=userName.replace(/[^\x00-\xFF]/g,"**").length;var userValue=userName;if(l!=11||userValue.substring(0,1)!="1"){if((l<1)){$(".shareIndexPrompt").text("用户名长度为1～20个字符").next().css("margin-top",0);$(".shareIndexLeft").css("margin-top",0);return false;}var reg=/^[a-zA-Z0-9.\-_]+$/;flag=reg.test(userName);if(!flag){$(".shareIndexPrompt").text("用户名格式错误").next().css("margin-top",0);$(".shareIndexLeft").css("margin-top",0);return false;}}l=passwordInput.value.replace(/[^\x00-\xFF]/g,"**").length;if((l<1)||(l>32)){$(".shareIndexPrompt").text("密码长度为1～32个字符").next().css("margin-top",0);$(".shareIndexLeft").css("margin-top",0);return false;}var passwordInputHid=document.getElementById("password1");passwordInputHid.value=passwordInput.value.trim();return true;}function getUrlParam(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null){return r[2];}return null;}function initShare(){toResetPasswordPage();toRegisterPage();var obj=document.getElementById("Cname_content");var obj1=document.getElementById("Cname_content_tip");if(obj.value.trim().length!=0){obj1.style.display="none";}obj.focus();var obj=document.getElementById("isAutoLogin");obj.onclick=function(){var val=document.getElementById("isAutoLogin");if(val.checked){val.setAttribute("value",1);}else{val.setAttribute("value",0);}};var submitBtn=document.getElementById("loginSubmitBtn");if(submitBtn!=null){submitBtn.onclick=function(){if(!checkInputDataForMailShare()){return false;}SetPwdAndChk();var phone=$("#Cname_content").val();var verifyCode=$("#Cpwd_pwd").val();if(phone!=""&&phone!=undefined&&phone!=null&&!isNaN(phone)&&phone.length==11){var param={actionType:"checkSmsVerifyCode",verifyCode:verifyCode,user:phone,domain:"wo.cn",mbid:$("#mbid").val()};$.ajax({type:"post",url:"shareRegister.action",data:param,async:false,success:function(data){if("0"==data.resultCode){$.post("shareRegister.action",{actionType:"order",user:phone},function(data){MailShareRegister.orderAndRegister();});}else{$("#remember").val("remember");loginshare();}}});}else{$("#remember").val("remember");loginshare();}};}document.onkeydown=function(event){e=event?event:(window.event?window.event:null);if(e.keyCode==13){submitBtn.click();}};}function loginshare(){var form=document.getElementById("loginForm");document.getElementById("username1").value=document.getElementById("Cname_content").value.trim();document.getElementById("password1").value=document.getElementById("Cpwd_pwd").value.trim();document.getElementById("autoLogin").value=document.getElementById("isAutoLogin").value;form.submit();}